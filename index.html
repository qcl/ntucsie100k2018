<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>è‡ºå¤§è³‡è¨Šèµ·è–ªç ´ 10 è¬ï¼</title>
    <meta property="og:title" content="è‡ºå¤§è³‡è¨Šèµ·è–ªç ´ 10 è¬ï¼" />
    <meta property="og:description" content="ã€Œä¸‰å¹´å…§ï¼Œå°å¤§è³‡å·¥ç•¢æ¥­èµ·è–ªå°‡ç ´å°å¹£ 10 è¬ã€ï¼ŒAppsWork å‰µå§‹åˆå¤¥äººæ—ä¹‹æ™¨åœ¨ 2015 å¹´ 5 æœˆ 20 æ—¥æ–¼å…¶ç¶²èªŒè¡¨ç¤ºã€‚" />
    <meta property="og:image" content="http://qcl.github.io/ntucsie100k2018/ntucsie100k.png" />
    <script>
let deadlineDate = new Date('2018-05-20T12:28:00+08:00');
let exchangeRates = {};
let currencies = {
    'TWD': 'æ–°è‡ºå¹£ğŸ‡¹ğŸ‡¼',
    'CNY': 'äººæ°‘å¹£ğŸ‡¨ğŸ‡³',
    'HKD': 'æ¸¯å¹£ğŸ‡­ğŸ‡°',
    'USD': 'ç¾å…ƒğŸ‡ºğŸ‡¸',
    'JPY': 'æ—¥åœ“ğŸ‡¯ğŸ‡µ',
    'EUR': 'æ­å…ƒğŸ‡ªğŸ‡º',
    'SGD': 'æ–°åŠ å¡å…ƒğŸ‡¸ğŸ‡¬',
    'GBP': 'è‹±éŠğŸ‡¬ğŸ‡§',
};
let diffTimeString = (startDate, endDate) => {
    let diffTime = endDate - startDate;
    if (diffTime <= 0) {
        return '0ç§’';
    }
    let restSeconds = Math.round(diffTime / 1000);
    let days = Math.round(restSeconds / 86400);

    restSeconds %= 86400;
    let hours = Math.round(restSeconds / 3600);
    
    restSeconds %= 3600;
    let minutes = Math.round(restSeconds / 60);

    restSeconds %= 60;
    let seconds = restSeconds;

    return ` ${days} å¤© ${hours} å°æ™‚ ${minutes} åˆ† ${seconds} ç§’`;
};
let updateCountdownTime = () => {
    let countdownSpan = document.querySelector('span#countdown');
    let couthdownText = diffTimeString(Date.now(), deadlineDate);
    countdownSpan.innerHTML = couthdownText;
};
let sec = 0;
let currentCurrency = 'TWD';
let update = setInterval(function(){
    sec++;
    updateCountdownTime();
    if (sec % 3 == 0 ) {
        updateSalary();
    }
    if (sec % (60 * 5) == 0) {
        updateExchangeRates();
    }
}, 1000);
let updateExchangeRates = () => {
    fetch('https://qcurrency-exchange-rates.appspot.com/api/latest').then(response => { return response.json(); }).then(jsonObj => {
        exchangeRates = jsonObj.rates;
        // append TWD manually
        exchangeRates['TWD'] = 1;
        console.log('exchange rates updated');
    });
};
updateExchangeRates();
let updateSalary = () => {
    let currencyNames = Object.keys(currencies);
    let c = currencyNames.length;
    let rate = 1;
    let baseSalary = 100000;
    let currencyName = 'æ–°è‡ºå¹£ğŸ‡¹ğŸ‡¼';
    while(true) {
        c = Math.round(Math.random() * currencyNames.length);
        if ( c >= currencyNames.length ) {
            continue;
        } else {
            let currency = currencyNames[c];
            if (currency != currentCurrency && exchangeRates[currency] != undefined) {
                currentCurrency = currency;
                currencyName = currencies[currency];
                rate = exchangeRates[currency];
                break;
            }
        }
    }
    let salaryUnit = (Math.round(Math.random() * 2) % 2 == 0) ? 1 : 12;
    let salaryUnitStr = (salaryUnit == 1) ? 'æœˆè–ª' : 'å¹´è–ª';
    let salary = Math.round(salaryUnit * baseSalary / rate);
    salaryStr = `ä½ çš„${salaryUnitStr}ç ´ ${salary} ${currencyName}äº†å—ï¼Ÿ`;
    let salaryH1 = document.querySelector('h1#salary');
    salaryH1.innerHTML = salaryStr;
};
    </script>
    <style>
.countdown-area {
    margin-top: 10vh;
    text-align: center;
}

.countdown-area #countdown {
    font-size: 2em;
}

.are-you-100k {
    text-align: center;      
}
.test:before {
    content: 'aaaa';
    transform: rotateX(20deg);
    background: yellow;
    position: absolute;
    top: 0;
}
.test {
    background: green;
}
.test:after {
    position: relative;
    display: block;
    background: red;
    content: 'test';
    top: 0;
    z-index: 0;
}

//@keyframe 
    </style>
</head>
<body>
    <div>
        <div class='countdown-area'>
            <p>é‚„æœ‰<span id='countdown'>æ™‚é–“å—ï¼Ÿ<span></p>
        </div>
        <div class='are-you-100k'>
            <h1 id='salary'>ä½ çš„æœˆè–ªç ´ 100000 æ–°è‡ºå¹£ğŸ‡¹ğŸ‡¼äº†å—ï¼Ÿ</h1>
            <p><a href='http://mrjamie.cc/2015/05/20/cs-crunch/'>ã€Œä¸‰å¹´å…§ï¼Œå°å¤§è³‡å·¥ç•¢æ¥­èµ·è–ªå°‡ç ´å°å¹£ 10 è¬ã€</a>(<a href='https://web.archive.org/web/20150522223407/http://mrjamie.cc/2015/05/20/cs-crunch/'>2015.05.20</a>)</p>
        </div>
    </div>
    <div>é€™æ˜¯ä¸€å€‹åœ¨<div>å¥å­<div></div></div>ä¸­çš„æ¸¬è©¦</div>
</body>
</html>

